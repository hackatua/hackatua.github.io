<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.4.0"/><link as="script" rel="preload" href="/webpack-runtime-985045ef1418e3ab0cfe.js"/><link as="script" rel="preload" href="/framework-3fc5895640b8716368a8.js"/><link as="script" rel="preload" href="/app-ae13a802a45426400976.js"/><link as="script" rel="preload" href="/commons-9a1e6a0d0161633618bb.js"/><link as="script" rel="preload" href="/component---src-templates-wiki-page-tsx-5209e2a7f0a76d5af851.js"/><link as="fetch" rel="preload" href="/page-data/wiki/nmap/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="sc-bdvvtL hBzEkC"><div class="sc-gsDKAQ jyA-dYq"><a class="sc-dkPtRN czCjnC" href="/">Hackatua</a><nav class="sc-hKwDye hWshXD"><a class="sc-eCImPb falHNY" href="/wiki">Wiki</a></nav></div></header><div class="sc-jRQBWg eKVfyA"><h1>Nmap</h1><div class="sc-gKclnd gYMTbI"><h1>Introducci√≥n</h1>
<p>Nmap (Network Mapper) es una herramienta libre y opensource especializada en la exploraci√≥n de redes y auditor√≠as de seguridad.</p>
<p>Utiliza paquetes IP en bruto para determinar cu√°les son los host actualmente disponibles en la red, qu√© servicios y versones de los mismos ofrecen estos hosts, qu√© sistema operativo est√° ejecutando, ...etc.</p>
<h1>Uso</h1>
<p><code>nmap [params] {target}</code></p>
<h2>Par√°metros</h2>
<p><code>--open</code>: muestra √∫nicamente los puertos abiertos</p>
<p><code>--min-rate &#x3C;value></code>:</p>
<p><code>-oG &#x3C;filename></code>: exporta en formato grepeable</p>
<p><code>-oN &#x3C;filename></code>: exporta en formato nmap</p>
<h3>Host Discovery</h3>
<p><code>-sn</code>/<code>-sP</code>: escaneo usando Ping (ICMP). Desabilita el escaneo de puertos.</p>
<aside>
üí° `-sP` es la nomenclatura antigual por el ICMP scan.
</aside>
<aside>
üí° Si realizamos este tipo de escaneo en una red local, nmap va a usar paquetes ARP para el escaneo, por lo que si el servidor tiene bloqueados los paquetes ICMP funcionar√≠a. En caso contrario, si la red no es local, usar√≠a paquetes ICMP y el firewall los bloquear√≠a.
Se puede usar el par√°metro `--send-ip` para forzar el escenario de una red no local.
</aside>
<p>Usa 4 t√©cnicas diferentes para realizar este descubrimiento, 2 usando ICMP, y 2 usando TCP.</p>
<p><code>-Pn</code>: Trata todos los hosts del target como online. No realiza host discovery.</p>
<p><code>-n</code>: Deshabilita la resoluci√≥n DNS</p>
<p><code>--traceroute</code>: Muestra el path hasta el host</p>
<h3>Scan techniques</h3>
<p>Por defecto nmap intenta usar la t√©cnica m√°s adecuada para el entorno del escaneo.</p>
<p><code>-sS</code>: TCP SYN Stealth scan (half open scan)</p>
<p><code>-sT</code>: TCP connect scan (full open scan)</p>
<h3>Port specification</h3>
<p>Si no se especifica el rango de puertos a escanear, nmap escane los 1000 puertos m√°s usados.</p>
<p><code>-p &#x3C;port ranges></code>: esanea √∫nicamente los puertos especificados. Ej:</p>
<ul>
<li><code>-p-</code>: escanea todos los puertos</li>
<li><code>-p22</code>: escanea √∫nicamente el puerto 22</li>
<li><code>-p1-65535</code>: escanea del puerto 1 al 65535</li>
<li><code>-p U:53,111,137,T:21-25,80,139,8080,S:9</code>: escanea los puertos especificados</li>
</ul>
<h3>Service/version detection</h3>
<p><code>-sV</code>: prueba los puertos abiertos para detectar el servicio y la versi√≥n de los mismos</p>
<h3>Scripts</h3>
<p><code>-sC</code>: aplica los scripts por defecto (<em>default scripts</em>).</p>
<p><code>--script=&#x3C;Lua scripts></code>: aplica los scripts especificados. Admite una lista de directorios, de ficheros de scripts o de categor√≠as de scripts. Ej:</p>
<ul>
<li><code>--script=banner</code>: ejecuta el script banner</li>
<li><code>--script=ip-geolocation-*</code>: ejecuta todos los scripts que empiezan por ‚Äúip-geolocation-‚Äù</li>
</ul>
<h3>OS detection</h3>
<p><code>-O</code>: habilita la detecci√≥n de sistema operativo</p>
<h3>Timing and performance</h3>
<p><code>-T&#x3C;0-5></code>: aplica diferentes plantillas de tiempo (0 m√°s lento a 5 m√°s r√°pido)</p>
<h3>Evasi√≥n y spoofing de Firewalls/IDS</h3>
<p><code>-f</code>: fragmetaci√≥n de paquetes</p>
<p><code>-D &#x3C;decoy1, decoy2, ...></code>: esconde tu informaci√≥n a trav√©s de un se√±uelo</p>
<p><code>-g</code>: puerto origen del escaneo</p>
<p><code>--badsum</code>: env√≠a paquetes TCP/UDP/SCTP con un checksum incorrecto</p>
<h3>Output</h3>
<p><code>-v</code>: incrementa la verbosidad de la salida. Se pueden agregar m√°s ‚Äúv‚Äù para incrementar el nivel de verbosidad. Ej:</p>
<ul>
<li><code>-vv</code></li>
<li><code>-vvv</code></li>
</ul>
<p><code>--packet-trace</code>: mustra todos los paquetes env√≠ados y recibidos en el escaneo</p>
<h3>Misc</h3>
<p><code>--send-ip</code>: fuerza el uso de paquetes IP para poder simular un entorno real en una red local.</p>
<p><code>-A</code>: aplica detecci√≥n de OS (<code>-O</code>), versiones y servicios (<code>-sV</code>), script scanning (<code>-sC</code>) y traceroute(<code>--traceroute</code>)</p>
<h2>Script engine</h2>
<p>Se encuentran en <code>/usr/share/nmap/scripts</code>.</p>
<p>Para listar los scripts con un texto concreto podemos usar <code>ls -l /usr/share/nmap/scripts/*{termino de b√∫squeda}*</code>.</p>
<h3>Scripts</h3>
<p><code>--script=banner</code>: similar a hacer usar netcat contra un puerto</p>
<h3>Categories</h3>
<p><code>--script=vuln</code>: ejecuta los scripts para la detecci√≥n de vulnerabilidades</p>
<h2>Ejemplos</h2>
<h3>Host discovery mediante Ping (ICMP)</h3>
<p><code>nmap -sn -v 192.168.0.70</code></p>
<h3>Host discovery mediante ICMP forzando uso de IP</h3>
<p><code>nmap -sn --send-ip -v 192.168.0.70</code></p>
<h3>Host discovery mediante ICMP forzando uso de IP mostrando paquetes</h3>
<p><code>nmap -sn --send-ip --packet-trace -v 192.168.0.70</code></p>
<h3>Escaneo (SYN Stealth) de los 1000 puertos m√°s comunes ignorando el host discovery y sin resoluci√≥n DNS</h3>
<p><code>nmap -n -Pn -v 192.168.0.70</code></p>
<h3>Escaneo (TCP connect) a puertos espec√≠ficos a toda la red</h3>
<p><code>nmap -sT -p 80,443 192.168.0.0/24</code></p>
<h3>Escaneo de versiones de servicios en puertos concretos ignorando host discovery y sin resoluci√≥n DNS</h3>
<p><code>nmap -n -Pn -v -sV -p22,80,443 192.168.0.70</code></p>
<h3>Escaneo de versiones de servicios y sistema operativo en puertos concretos ignorando host discovery y sin resoluci√≥n DNS</h3>
<p><code>nmap -n -Pn -v -sV -O -p22,80,443 192.168.0.70</code></p>
<h3>Escaneo (SYN Stealth) de los 1000 puertos m√°s comunes ignorando el host discovery y sin resoluci√≥n DNS, y con fragmentaci√≥n de paquetes</h3>
<p><code>nmap -n -Pn -v -f 192.168.0.70</code></p>
<h3>Escaneo (SYN Stealth) de los 1000 puertos m√°s comunes ignorando el host discovery y sin resoluci√≥n DNS, y con se√±uelo</h3>
<p><code>nmap -n -Pn -v -D 192.168.0.50 192.168.0.70</code></p>
<h3>Escaneo (SYN Stealth) de los 1000 puertos m√°s comunes ignorando el host discovery y sin resoluci√≥n DNS, y con puerto origen definido</h3>
<p><code>nmap -n -Pn -v -g 80 192.168.0.70</code></p>
<h3>Escaneo (SYN Stealth) de los 1000 puertos m√°s comunes ignorando el host discovery y sin resoluci√≥n DNS, y con checksum err√≥neo</h3>
<p><code>nmap -n -Pn -v --badsum 192.168.0.70</code></p>
<h3>Escaneo (SYN Stealth) de puertos espec√≠ficos ignorando el host discovery y sin resoluci√≥n DNS, aplicando los scripts por defecto</h3>
<p><code>nmap -n -Pn -v -sV --script=default -p22,80,443 192.168.0.70</code></p></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/wiki/nmap/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-33ce00ce9a9fa4784e76.js"],"app":["/app-ae13a802a45426400976.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-1197eee13d9d48b5f82d.js"],"component---src-pages-wiki-tsx":["/component---src-pages-wiki-tsx-b740b3ec9f5e93707af6.js"],"component---src-templates-wiki-page-tsx":["/component---src-templates-wiki-page-tsx-5209e2a7f0a76d5af851.js"]};/*]]>*/</script><script src="/polyfill-33ce00ce9a9fa4784e76.js" nomodule=""></script><script src="/component---src-templates-wiki-page-tsx-5209e2a7f0a76d5af851.js" async=""></script><script src="/commons-9a1e6a0d0161633618bb.js" async=""></script><script src="/app-ae13a802a45426400976.js" async=""></script><script src="/framework-3fc5895640b8716368a8.js" async=""></script><script src="/webpack-runtime-985045ef1418e3ab0cfe.js" async=""></script></body></html>